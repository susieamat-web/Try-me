<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rabbit Adventure: Solo Quest</title>
    <style>
        body { margin: 0; text-align: center; background: #1a1a1a; font-family: Arial, sans-serif; overflow: hidden; }
        canvas { display: block; margin: 0 auto; background: #87CEEB; border-bottom: 10px solid #2e7d32; }
        .ui { color: white; position: absolute; top: 10px; width: 100%; pointer-events: none; }
        .controls { position: absolute; bottom: 20px; width: 100%; display: flex; justify-content: center; gap: 10px; }
        button { 
            padding: 15px 25px; font-size: 16px; cursor: pointer; pointer-events: auto;
            border-radius: 10px; border: 2px solid white; background: #333; color: white;
        }
        #start-screen { position: absolute; inset: 0; background: rgba(0,0,0,0.8); display: flex; 
                        flex-direction: column; align-items: center; justify-content: center; color: white; z-index: 10; }
    </style>
</head>
<body>

<div id="start-screen">
    <h1>ðŸ¥• KONIJN AVONTUUR</h1>
    <p id="highscore-text">Highscore: 0</p>
    <button onclick="startGame()">START SPEL</button>
</div>

<div class="ui">
    <h2 id="stats">Level: 1 | Punten: 0</h2>
</div>

<div class="controls">
    <button onclick="jump()">SPRING (Spatie)</button>
    <button onclick="shoot()">SCHIET (F)</button>
</div>

<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
canvas.width = 800;
canvas.height = 400;

// Constanten
const GROUND_Y = 310;
let gameActive = false;
let score = 0;
let level = 1;
let frame = 0;
let highscore = localStorage.getItem("rabbitHS") || 0;

document.getElementById("highscore-text").innerText = "Highscore: " + highscore;

// Objecten
let rabbit = { x: 50, y: GROUND_Y, w: 40, h: 40, dy: 0, jumping: false };
let obstacles = [];
let bullets = [];
let boss = null;

function startGame() {
    document.getElementById("start-screen").style.display = "none";
    gameActive = true;
    score = 0;
    level = 1;
    obstacles = [];
    bullets = [];
    boss = null;
    rabbit.y = GROUND_Y;
    requestAnimationFrame(gameLoop);
}

function drawRabbit() {
    ctx.fillStyle = "white";
    // Lichaam
    ctx.beginPath(); ctx.ellipse(rabbit.x + 20, rabbit.y + 25, 18, 14, 0, 0, Math.PI * 2); ctx.fill();
    // Hoofd
    ctx.beginPath(); ctx.arc(rabbit.x + 30, rabbit.y + 10, 11, 0, Math.PI * 2); ctx.fill();
    // Oortjes
    ctx.beginPath(); ctx.ellipse(rabbit.x + 25, rabbit.y - 5, 5, 12, 0.1, 0, Math.PI * 2); ctx.fill();
    ctx.beginPath(); ctx.ellipse(rabbit.x + 34, rabbit.y - 5, 5, 12, -0.1, 0, Math.PI * 2); ctx.fill();
}

function drawCarrot(x, y) {
    ctx.fillStyle = "#FF9800"; // Oranje
    ctx.beginPath();
    ctx.moveTo(x, y);
    ctx.lineTo(x + 25, y);
    ctx.lineTo(x + 12, y + 35);
    ctx.fill();
    ctx.fillStyle = "#4CAF50"; // Groen loof
    ctx.fillRect(x + 8, y - 8, 10, 8);
}

function drawBush(x, y) {
    ctx.fillStyle = "#1B5E20"; // Donkergroen
    ctx.beginPath(); ctx.arc(x + 10, y + 25, 15, 0, Math.PI * 2); ctx.fill();
    ctx.beginPath(); ctx.arc(x + 25, y + 20, 15, 0, Math.PI * 2); ctx.fill();
}

function gameLoop() {
    if (!gameActive) return;
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    frame++;

    // Zwaartekracht
    if (rabbit.y < GROUND_Y) {
        rabbit.dy += 0.8;
    } else {
        rabbit.y = GROUND_Y;
        rabbit.dy = 0;
        rabbit.jumping = false;
    }
    rabbit.y += rabbit.dy;
    drawRabbit();

    // Spawn systeem
    if (frame % Math.max(30, 100 - (level * 3)) === 0 && !boss) {
        let isAir = Math.random() > 0.5;
        obstacles.push({
            x: 850,
            y: isAir ? 200 : GROUND_Y,
            w: 30,
            h: 30,
            type: isAir ? 'air' : 'ground'
        });
    }

    // Boss bij level 10 en 20
    if ((level === 10 || level === 20) && !boss) {
        boss = { x: 600, y: 150, w: 80, h: 80, hp: level === 10 ? 5 : 10, max: level === 10 ? 5 : 10, dir: 2 };
    }

    if (boss) {
        boss.y += boss.dir;
        if (boss.y > 250 || boss.y < 50) boss.dir *= -1;
        ctx.fillStyle = "purple";
        ctx.fillRect(boss.x, boss.y, boss.w, boss.h);
        ctx.fillStyle = "red";
        ctx.fillRect(boss.x, boss.y - 15, (boss.hp / boss.max) * 80, 8);
    }

    // Obstakels bewegen
    obstacles.forEach((obs, i) => {
        obs.x -= (5 + level);
        if (obs.type === 'air') drawCarrot(obs.x, obs.y);
        else drawBush(obs.x, obs.y);

        // Botsing konijn
        if (rabbit.x < obs.x + obs.w && rabbit.x + 35 > obs.x && rabbit.y < obs.y + obs.h && rabbit
