<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Rabbit Worlds: Lion Hunter</title>
    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { 
            margin: 0; padding: 0; background: #1a1a1a; 
            font-family: sans-serif; color: white; 
            overflow: hidden; touch-action: none;
            display: flex; flex-direction: column; height: 100vh;
        }
        #game-container { 
            flex-grow: 1; position: relative; width: 100%; overflow: hidden;
            display: flex; align-items: center; justify-content: center;
        }
        canvas { 
            display: block; width: 100%; height: auto; 
            max-width: 800px; background: #87CEEB;
        }
        .ui { 
            position: absolute; top: 10px; width: 100%; 
            text-align: center; pointer-events: none; 
            font-weight: bold; font-size: 20px; text-shadow: 2px 2px #000; z-index: 5;
        }
        .controls { 
            display: flex; width: 100%; height: 120px; 
            background: #222; padding: 10px; gap: 10px;
        }
        button { 
            flex: 1; font-size: 22px; cursor: pointer; border-radius: 15px; 
            border: none; background: #eee; font-weight: bold; color: #333;
        }
        #start-overlay { 
            position: absolute; inset: 0; background: rgba(0,0,0,0.9); 
            display: flex; flex-direction: column; justify-content: center; 
            align-items: center; z-index: 100;
        }
    </style>
</head>
<body>

<div id="start-overlay">
    <h1 style="color: orange; font-size: 40px; margin-bottom: 10px;">RABBIT WORLDS</h1>
    <p style="margin-bottom: 20px;">Stone Age: Lion Edition</p>
    <button onclick="startGame()" style="width: 200px; height: 60px; background: orange; color: white; flex: none;">START NU</button>
</div>

<div class="ui">Score: <span id="scoreVal">0</span> | Level: <span id="lvlVal">1</span></div>

<div id="game-container">
    <canvas id="gameCanvas" width="800" height="400"></canvas>
</div>

<div class="controls">
    <button id="jumpBtn" style="background: #ffffff;">SPRING</button>
    <button id="fireBtn" style="background: #ff9800; color: white;">VUUR ðŸ”¥</button>
</div>

<script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    
    let score = 0, level = 1, running = false, frame = 0;
    let p = { x: 50, y: 310, w: 50, h: 50, dy: 0, jump: false };
    let stones = [], logs = [], baas = null;

    function startGame() {
        document.getElementById("start-overlay").style.display = "none";
        if (running) return;
        running = true;
        // Gebruik setInterval voor maximale stabiliteit op alle browsers
        setInterval(gameLoop, 1000 / 60); 
    }

    // Besturing voor mobiel en desktop
    const jumpBtn = document.getElementById("jumpBtn");
    const fireBtn = document.getElementById("fireBtn");

    function jump() { if (!p.jump && running) { p.dy = -16; p.jump = true; } }
    function fire() { if (running) stones.push({ x: p.x + 40, y: p.y + 25 }); }

    jumpBtn.onmousedown = jumpBtn.ontouchstart = (e) => { e.preventDefault(); jump(); };
    fireBtn.onmousedown = fireBtn.ontouchstart = (e) => { e.preventDefault(); fire(); };

    function drawRabbit(x, y) {
        ctx.fillStyle = "white";
        ctx.beginPath(); ctx.ellipse(x + 25, y + 30, 20, 15, 0, 0, Math.PI * 2); ctx.fill();
        ctx.beginPath(); ctx.arc(x + 35, y + 15, 12, 0, Math.PI * 2); ctx.fill();
        ctx.fillStyle = "pink"; ctx.fillRect(x + 30, y - 10, 6, 20); ctx.fillRect(x + 40, y - 10, 6, 20);
    }

    function drawLion(x, y) {
        ctx.fillStyle = "#8B4513"; ctx.beginPath(); ctx.arc(x + 50, y + 50, 45, 0, Math.PI * 2); ctx.fill();
        ctx.fillStyle = "#FFD700"; ctx.beginPath(); ctx.arc(x + 50, y + 55, 30, 0, Math.PI * 2); ctx.fill();
        ctx.fillStyle = "black"; ctx.beginPath(); ctx.arc(x + 40, y + 50, 4, 0, Math.PI * 2); ctx.fill();
        ctx.beginPath(); ctx.arc(x + 60, y + 50, 4, 0, Math.PI * 2); ctx.fill();
    }

    function gameLoop() {
        if (!running) return;
        ctx.clearRect(0, 0, 800, 400);
        frame++;

        // Speler beweging
        p.dy += 0.8;
        p.y += p.dy;
        if (p.y > 310) { p.y = 310; p.dy = 0; p.jump = false; }
        drawRabbit(p.x, p.y);

        // Leeuw Baas verschijning
        if (level >= 3 && !baas) {
            baas = { x: 650, y: 100, hp: 15, max: 15, dir: 3 };
        }
        if (baas) {
            baas.y += baas.dir;
            if (baas.y > 280 || baas.y < 20) baas.dir *= -1;
            drawLion(baas.x, baas.y);
            ctx.fillStyle = "red"; ctx.fillRect(baas.x, baas.y - 15, (baas.hp/baas.max) * 100, 8);
        }

        // Boomstammen aanmaken
        if (frame % Math.max(30, 90 - (level * 5)) === 0 && !baas) {
            logs.push({ x: 850, y: 335, w: 60, h: 40 });
        }

        // Boomstammen bewegen en checken
        for (let i = logs.length - 1; i >= 0; i--) {
            let l = logs[i];
            l.x -= (5 + level);
            ctx.fillStyle = "#8B4513";
            ctx.fillRect(l.x, l.y, l.w, l.h);

            // Botsing met konijn
            if (p.x < l.x + l.w && p.x + 40 > l.x && p.y < l.y + l.h && p.y + 40 > l.y) {
                running = false; 
                alert("Game Over! Score: " + score);
                location.reload();
            }
            if (l.x < -100) logs.splice(i, 1);
        }

        // Stenen (Kogels)
        for (let si = stones.length - 1; si >= 0; si--) {
            let s = stones[si];
            s.x += 12;
            ctx.fillStyle = "gray"; ctx.beginPath(); ctx.arc(s.x, s.y, 10, 0, Math.PI*2); ctx.fill();
            
            let hit = false;
            // Hit op Boomstam
            for (let li = logs.length - 1; li >= 0; li--) {
                let l = logs[li];
                if (s.x > l.x && s.x < l.x + l.w && s.y > l.y && s.y < l.y + l.h) {
                    logs.splice(li, 1); hit = true; score += 50; break;
                }
            }
            // Hit op Baas
            if (!hit && baas && s.x > baas.x && s.x < baas.x + 100 && s.y > baas.y && s.y < baas.y + 100) {
                baas.hp--; hit = true;
                if (baas.hp <= 0) { baas = null; level++; score += 500; }
            }

            if (hit || s.x > 850) stones.splice(si, 1);
        }

        if (score > level * 1000 && !baas) level++;
        document.getElementById("scoreVal").innerText = score;
        document.getElementById("lvlVal").innerText = level;
    }
</script>
</body>
</html>
